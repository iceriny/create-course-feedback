import{r as e,t,j as s,y as o,s as a,E as l,S as n,B as i,I as r,G as c,H as d,d as p,J as m}from"./vendor-react-antd-C70m5OuJ.js";import{A as h,P as x,s as j}from"./index-CQ__gtU6.js";import"./vendor-dayjs-BMl2ZANK.js";import{D as g}from"./vendor-others-B_SqjRtK.js";const{useToken:u}=t,y=e.memo((({open:t,setOpen:y,model:v,setModel:k,promptItems:f,setPromptItems:C,promptKey:b,setPromptKey:A,sendMessage:P})=>{const{token:I}=u(),[w,T]=e.useState(h.getProvider()),[S,M]=e.useState(h.getCustomProviderConfig().apiUrl),[_,L]=e.useState(h.getCustomProviderConfig().modelListUrl);return s.jsx(o,{title:"设置",onClose:()=>{y(!1)},open:t,children:s.jsxs(a,{vertical:!0,gap:8,children:[s.jsxs(a,{gap:5,align:"center",justify:"space-between",children:[s.jsx(l.Text,{children:"AI提供商:"}),s.jsx(n,{style:{width:"80%"},value:w,options:h.getProviders(),onChange:e=>{T(e),h.setProvider(e);let t="";switch(e){case"siliconflow":t="已切换到硅基流动供应商";break;case"openai":t="已切换到OpenAI供应商";break;case"deepseek":t="已切换到DeepSeek供应商";break;case"gemini":t="已切换到Gemini供应商";break;case"custom":t="已切换到自定义供应商";break;default:t="已切换供应商"}t+="，正在尝试加载可用模型列表，请稍等...",P(t),setTimeout((()=>{h.isCustomModelAllowed()&&P("未能获取模型列表或供应商不支持模型列表API，请手动输入模型名称")}),2e3)}})]}),"siliconflow"===w&&s.jsxs(a,{vertical:!0,gap:5,children:[s.jsx(l.Text,{type:"secondary",children:"硅基流动是推荐的中文AI服务提供商"}),s.jsx(i,{type:"link",href:"https://cloud.siliconflow.cn/i/8jXtDiez",target:"_blank",children:"点击这里注册获取2000万免费Tokens"})]}),"deepseek"===w&&s.jsxs(a,{vertical:!0,gap:5,children:[s.jsx(l.Text,{type:"secondary",children:"DeepSeek提供高性能的推理和对话模型"}),s.jsx(i,{type:"link",href:"https://platform.deepseek.com/api_keys",target:"_blank",children:"点击这里申请DeepSeek API密钥"})]}),"openai"===w&&s.jsxs(a,{vertical:!0,gap:5,children:[s.jsx(l.Text,{type:"secondary",children:"OpenAI提供GPT系列大语言模型"}),s.jsx(i,{type:"link",href:"https://platform.openai.com/api-keys",target:"_blank",children:"点击这里申请OpenAI API密钥"})]}),"gemini"===w&&s.jsxs(a,{vertical:!0,gap:5,children:[s.jsx(l.Text,{type:"secondary",children:"Gemini是Google开发的先进大语言模型"}),s.jsx(i,{type:"link",href:"https://ai.google.dev/",target:"_blank",children:"点击这里申请Gemini API密钥"})]}),"custom"===w&&s.jsxs(a,{vertical:!0,gap:10,children:[s.jsx(l.Text,{children:"自定义供应商设置:"}),s.jsx(l.Text,{type:"secondary",children:"可配置兼容OpenAI格式的API服务，例如本地部署的LLM、私有云等"}),s.jsx(r,{addonBefore:"API基础URL",placeholder:"https://your-api-endpoint.com",value:S.split("/v1/chat/completions")[0],onChange:e=>{const t=e.target.value.trim();M(`${t}/v1/chat/completions`),L(`${t}/v1/models`)}}),s.jsx(r,{addonBefore:"聊天完成URL",placeholder:"https://your-api-endpoint.com/v1/chat/completions",value:S,onChange:e=>M(e.target.value)}),s.jsx(r,{addonBefore:"模型列表URL",placeholder:"https://your-api-endpoint.com/v1/models",value:_,onChange:e=>L(e.target.value)}),s.jsx(i,{type:"primary",onClick:()=>{h.setCustomProviderConfig({apiUrl:S,modelListUrl:_}),P("自定义供应商配置已保存，请刷新页面加载可用模型")},children:"保存配置"})]}),s.jsx(c,{}),s.jsxs(a,{gap:5,align:"center",justify:"space-between",children:[s.jsx(l.Text,{children:"模型:"}),h.model_list.length>0&&!h.isCustomModelAllowed()?s.jsx(n,{style:{width:"85%"},value:v,options:h.model_list.map((e=>({value:e,label:e}))),onSelect:e=>{k(e),h.setModel(e)}}):s.jsx(r,{style:{width:"85%"},placeholder:"请输入模型名称",value:v,onChange:e=>{const t=e.target.value;k(t),h.setCustomModel(t)}})]}),h.isCustomModelAllowed()&&s.jsx(l.Text,{type:"secondary",style:{fontSize:"12px"},children:"未检测到可用的模型列表，请手动输入模型名称"}),s.jsx(r,{addonBefore:"请输入API Key",placeholder:h.tokenReady()?h.getMackToken():"请输入",onChange:e=>{const t=e.target.value.trim();h.setToken(t),localStorage.setItem("api_key",t),P("API Key设置成功, 请刷新页面加载可用模型.")}}),s.jsxs(a,{vertical:!0,gap:5,justify:"space-between",children:[s.jsxs(a,{align:"center",justify:"space-between",children:[s.jsx(l.Text,{children:"提示词:"}),s.jsx(d,{title:"选择模板",children:s.jsx(n,{style:{width:"30%"},defaultValue:"programming",options:[...Object.entries(f).map((e=>({value:e[0],label:e[1].name}))),{value:"custom",label:"自定义"}],onSelect:e=>{if("custom"===e){const e=g();C({...f,[e]:{name:"请输入提示词名称",prompt:f[b].prompt}}),A(e)}else A(e)}})})]}),s.jsx(r,{addonBefore:"名称",addonAfter:s.jsxs(a,{gap:20,children:[s.jsx(p,{style:{fontSize:I.controlHeightXS,color:b in x?void 0:I.colorError},onClick:()=>{const e={...f};delete e[b],A(Object.keys(f)[0]),C(e),j(e)}}),s.jsx(m,{style:{fontSize:I.controlHeightXS,color:b in x?void 0:I.colorPrimary},onClick:()=>{j(f)}})]}),value:f[b].name,disabled:b in x,onChange:e=>{const t=e.target.value,s={...f,[b]:{...f[b],name:t}};C(s)}}),s.jsx(r.TextArea,{disabled:b in x,value:f[b].prompt,autoSize:{minRows:10,maxRows:15},title:"提示语",onChange:e=>{const t=e.target.value,s={...f,[b]:{...f[b],prompt:t}};C(s)}})]})]})})}));export{y as default};
